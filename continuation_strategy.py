
import pandas as pd
import numpy as np
from zoneinfo import ZoneInfo  # <--- Make sure this is imported

# --- HARDCODED STRATEGY CONFIGURATIONS ---
# This dictionary contains the specific parameters for all 522 robust strategies.
STRATEGY_CONFIGS = {'Q4_W45_D7_Asia': {'Quarter': 4, 'Week': 45, 'Day': 7, 'Session': 'Asia'}, 'Q3_W28_D3_London': {'Quarter': 3, 'Week': 28, 'Day': 3, 'Session': 'London'}, 'Q2_W24_D1_Asia': {'Quarter': 2, 'Week': 24, 'Day': 1, 'Session': 'Asia'}, 'Q2_W19_D7_Asia': {'Quarter': 2, 'Week': 19, 'Day': 7, 'Session': 'Asia'}, 'Q4_W52_D2_NY': {'Quarter': 4, 'Week': 52, 'Day': 2, 'Session': 'NY'}, 'Q2_W20_D1_Asia': {'Quarter': 2, 'Week': 20, 'Day': 1, 'Session': 'Asia'}, 'Q1_W7_D4_Asia': {'Quarter': 1, 'Week': 7, 'Day': 4, 'Session': 'Asia'}, 'Q3_W30_D7_Asia': {'Quarter': 3, 'Week': 30, 'Day': 7, 'Session': 'Asia'}, 'Q4_W43_D7_Asia': {'Quarter': 4, 'Week': 43, 'Day': 7, 'Session': 'Asia'}, 'Q1_W4_D7_Asia': {'Quarter': 1, 'Week': 4, 'Day': 7, 'Session': 'Asia'}, 'Q2_W22_D1_Asia': {'Quarter': 2, 'Week': 22, 'Day': 1, 'Session': 'Asia'}, 'Q2_W22_D7_Asia': {'Quarter': 2, 'Week': 22, 'Day': 7, 'Session': 'Asia'}, 'Q4_W51_D1_London': {'Quarter': 4, 'Week': 51, 'Day': 1, 'Session': 'London'}, 'Q1_W13_D4_Asia': {'Quarter': 1, 'Week': 13, 'Day': 4, 'Session': 'Asia'}, 'Q1_W5_D7_Asia': {'Quarter': 1, 'Week': 5, 'Day': 7, 'Session': 'Asia'}, 'Q1_W9_D4_Asia': {'Quarter': 1, 'Week': 9, 'Day': 4, 'Session': 'Asia'}, 'Q4_W48_D7_Asia': {'Quarter': 4, 'Week': 48, 'Day': 7, 'Session': 'Asia'}, 'Q2_W22_D3_Asia': {'Quarter': 2, 'Week': 22, 'Day': 3, 'Session': 'Asia'}, 'Q3_W34_D1_NY': {'Quarter': 3, 'Week': 34, 'Day': 1, 'Session': 'NY'}, 'Q3_W30_D5_Asia': {'Quarter': 3, 'Week': 30, 'Day': 5, 'Session': 'Asia'}, 'Q2_W19_D1_Asia': {'Quarter': 2, 'Week': 19, 'Day': 1, 'Session': 'Asia'}, 'Q3_W31_D2_Asia': {'Quarter': 3, 'Week': 31, 'Day': 2, 'Session': 'Asia'}, 'Q2_W26_D1_Asia': {'Quarter': 2, 'Week': 26, 'Day': 1, 'Session': 'Asia'}, 'Q4_W50_D3_Asia': {'Quarter': 4, 'Week': 50, 'Day': 3, 'Session': 'Asia'}, 'Q3_W28_D3_Asia': {'Quarter': 3, 'Week': 28, 'Day': 3, 'Session': 'Asia'}, 'Q1_W2_D1_NY': {'Quarter': 1, 'Week': 2, 'Day': 1, 'Session': 'NY'}, 'Q1_W6_D4_Asia': {'Quarter': 1, 'Week': 6, 'Day': 4, 'Session': 'Asia'}, 'Q1_W10_D2_London': {'Quarter': 1, 'Week': 10, 'Day': 2, 'Session': 'London'}, 'Q3_W27_D4_London': {'Quarter': 3, 'Week': 27, 'Day': 4, 'Session': 'London'}, 'Q2_W18_D3_Asia': {'Quarter': 2, 'Week': 18, 'Day': 3, 'Session': 'Asia'}, 'Q4_W45_D5_NY': {'Quarter': 4, 'Week': 45, 'Day': 5, 'Session': 'NY'}, 'Q1_W9_D5_Asia': {'Quarter': 1, 'Week': 9, 'Day': 5, 'Session': 'Asia'}, 'Q4_W50_D2_NY': {'Quarter': 4, 'Week': 50, 'Day': 2, 'Session': 'NY'}, 'Q4_W47_D3_London': {'Quarter': 4, 'Week': 47, 'Day': 3, 'Session': 'London'}, 'Q3_W31_D7_Asia': {'Quarter': 3, 'Week': 31, 'Day': 7, 'Session': 'Asia'}, 'Q4_W46_D2_Asia': {'Quarter': 4, 'Week': 46, 'Day': 2, 'Session': 'Asia'}, 'Q3_W34_D2_Asia': {'Quarter': 3, 'Week': 34, 'Day': 2, 'Session': 'Asia'}, 'Q3_W29_D3_Asia': {'Quarter': 3, 'Week': 29, 'Day': 3, 'Session': 'Asia'}, 'Q1_W10_D4_Asia': {'Quarter': 1, 'Week': 10, 'Day': 4, 'Session': 'Asia'}, 'Q1_W3_D5_Asia': {'Quarter': 1, 'Week': 3, 'Day': 5, 'Session': 'Asia'}, 'Q3_W36_D2_Asia': {'Quarter': 3, 'Week': 36, 'Day': 2, 'Session': 'Asia'}, 'Q3_W31_D3_Asia': {'Quarter': 3, 'Week': 31, 'Day': 3, 'Session': 'Asia'}, 'Q4_W45_D2_Asia': {'Quarter': 4, 'Week': 45, 'Day': 2, 'Session': 'Asia'}, 'Q2_W25_D4_Asia': {'Quarter': 2, 'Week': 25, 'Day': 4, 'Session': 'Asia'}, 'Q1_W6_D3_London': {'Quarter': 1, 'Week': 6, 'Day': 3, 'Session': 'London'}, 'Q2_W26_D5_London': {'Quarter': 2, 'Week': 26, 'Day': 5, 'Session': 'London'}, 'Q2_W20_D1_London': {'Quarter': 2, 'Week': 20, 'Day': 1, 'Session': 'London'}, 'Q2_W22_D2_Asia': {'Quarter': 2, 'Week': 22, 'Day': 2, 'Session': 'Asia'}, 'Q1_W4_D4_Asia': {'Quarter': 1, 'Week': 4, 'Day': 4, 'Session': 'Asia'}, 'Q3_W33_D5_London': {'Quarter': 3, 'Week': 33, 'Day': 5, 'Session': 'London'}, 'Q2_W16_D3_Asia': {'Quarter': 2, 'Week': 16, 'Day': 3, 'Session': 'Asia'}, 'Q1_W2_D1_London': {'Quarter': 1, 'Week': 2, 'Day': 1, 'Session': 'London'}, 'Q1_W2_D7_Asia': {'Quarter': 1, 'Week': 2, 'Day': 7, 'Session': 'Asia'}, 'Q4_W44_D2_London': {'Quarter': 4, 'Week': 44, 'Day': 2, 'Session': 'London'}, 'Q4_W50_D1_NY': {'Quarter': 4, 'Week': 50, 'Day': 1, 'Session': 'NY'}, 'Q3_W31_D1_London': {'Quarter': 3, 'Week': 31, 'Day': 1, 'Session': 'London'}, 'Q3_W36_D2_London': {'Quarter': 3, 'Week': 36, 'Day': 2, 'Session': 'London'}, 'Q3_W29_D3_London': {'Quarter': 3, 'Week': 29, 'Day': 3, 'Session': 'London'}, 'Q2_W22_D4_London': {'Quarter': 2, 'Week': 22, 'Day': 4, 'Session': 'London'}, 'Q3_W27_D2_NY': {'Quarter': 3, 'Week': 27, 'Day': 2, 'Session': 'NY'}, 'Q3_W33_D2_NY': {'Quarter': 3, 'Week': 33, 'Day': 2, 'Session': 'NY'}, 'Q1_W6_D2_London': {'Quarter': 1, 'Week': 6, 'Day': 2, 'Session': 'London'}, 'Q3_W37_D2_Asia': {'Quarter': 3, 'Week': 37, 'Day': 2, 'Session': 'Asia'}, 'Q3_W27_D3_NY': {'Quarter': 3, 'Week': 27, 'Day': 3, 'Session': 'NY'}, 'Q4_W51_D3_Asia': {'Quarter': 4, 'Week': 51, 'Day': 3, 'Session': 'Asia'}, 'Q1_W4_D2_London': {'Quarter': 1, 'Week': 4, 'Day': 2, 'Session': 'London'}, 'Q4_W44_D3_Asia': {'Quarter': 4, 'Week': 44, 'Day': 3, 'Session': 'Asia'}, 'Q1_W7_D2_London': {'Quarter': 1, 'Week': 7, 'Day': 2, 'Session': 'London'}, 'Q4_W44_D7_Asia': {'Quarter': 4, 'Week': 44, 'Day': 7, 'Session': 'Asia'}, 'Q2_W24_D2_Asia': {'Quarter': 2, 'Week': 24, 'Day': 2, 'Session': 'Asia'}, 'Q1_W3_D5_London': {'Quarter': 1, 'Week': 3, 'Day': 5, 'Session': 'London'}, 'Q4_W45_D1_Asia': {'Quarter': 4, 'Week': 45, 'Day': 1, 'Session': 'Asia'}, 'Q4_W51_D4_Asia': {'Quarter': 4, 'Week': 51, 'Day': 4, 'Session': 'Asia'}, 'Q3_W30_D3_Asia': {'Quarter': 3, 'Week': 30, 'Day': 3, 'Session': 'Asia'}, 'Q4_W42_D1_London': {'Quarter': 4, 'Week': 42, 'Day': 1, 'Session': 'London'}, 'Q4_W49_D3_Asia': {'Quarter': 4, 'Week': 49, 'Day': 3, 'Session': 'Asia'}, 'Q4_W45_D4_London': {'Quarter': 4, 'Week': 45, 'Day': 4, 'Session': 'London'}, 'Q3_W35_D4_Asia': {'Quarter': 3, 'Week': 35, 'Day': 4, 'Session': 'Asia'}, 'Q1_W4_D3_London': {'Quarter': 1, 'Week': 4, 'Day': 3, 'Session': 'London'}, 'Q3_W29_D1_London': {'Quarter': 3, 'Week': 29, 'Day': 1, 'Session': 'London'}, 'Q3_W36_D7_Asia': {'Quarter': 3, 'Week': 36, 'Day': 7, 'Session': 'Asia'}, 'Q3_W37_D1_Asia': {'Quarter': 3, 'Week': 37, 'Day': 1, 'Session': 'Asia'}, 'Q3_W28_D1_Asia': {'Quarter': 3, 'Week': 28, 'Day': 1, 'Session': 'Asia'}, 'Q3_W28_D2_Asia': {'Quarter': 3, 'Week': 28, 'Day': 2, 'Session': 'Asia'}, 'Q3_W27_D3_Asia': {'Quarter': 3, 'Week': 27, 'Day': 3, 'Session': 'Asia'}, 'Q1_W10_D2_NY': {'Quarter': 1, 'Week': 10, 'Day': 2, 'Session': 'NY'}, 'Q4_W43_D5_London': {'Quarter': 4, 'Week': 43, 'Day': 5, 'Session': 'London'}, 'Q3_W38_D2_London': {'Quarter': 3, 'Week': 38, 'Day': 2, 'Session': 'London'}, 'Q3_W37_D4_NY': {'Quarter': 3, 'Week': 37, 'Day': 4, 'Session': 'NY'}, 'Q1_W4_D3_Asia': {'Quarter': 1, 'Week': 4, 'Day': 3, 'Session': 'Asia'}, 'Q1_W13_D4_London': {'Quarter': 1, 'Week': 13, 'Day': 4, 'Session': 'London'}, 'Q3_W37_D2_NY': {'Quarter': 3, 'Week': 37, 'Day': 2, 'Session': 'NY'}, 'Q2_W24_D4_London': {'Quarter': 2, 'Week': 24, 'Day': 4, 'Session': 'London'}, 'Q4_W40_D3_Asia': {'Quarter': 4, 'Week': 40, 'Day': 3, 'Session': 'Asia'}, 'Q2_W21_D2_Asia': {'Quarter': 2, 'Week': 21, 'Day': 2, 'Session': 'Asia'}, 'Q1_W8_D2_NY': {'Quarter': 1, 'Week': 8, 'Day': 2, 'Session': 'NY'}, 'Q1_W2_D2_Asia': {'Quarter': 1, 'Week': 2, 'Day': 2, 'Session': 'Asia'}, 'Q3_W31_D5_Asia': {'Quarter': 3, 'Week': 31, 'Day': 5, 'Session': 'Asia'}, 'Q1_W6_D5_London': {'Quarter': 1, 'Week': 6, 'Day': 5, 'Session': 'London'}, 'Q1_W13_D5_NY': {'Quarter': 1, 'Week': 13, 'Day': 5, 'Session': 'NY'}, 'Q3_W37_D4_Asia': {'Quarter': 3, 'Week': 37, 'Day': 4, 'Session': 'Asia'}, 'Q2_W26_D3_Asia': {'Quarter': 2, 'Week': 26, 'Day': 3, 'Session': 'Asia'}, 'Q3_W29_D1_NY': {'Quarter': 3, 'Week': 29, 'Day': 1, 'Session': 'NY'}, 'Q2_W23_D1_NY': {'Quarter': 2, 'Week': 23, 'Day': 1, 'Session': 'NY'}, 'Q1_W4_D1_London': {'Quarter': 1, 'Week': 4, 'Day': 1, 'Session': 'London'}, 'Q3_W29_D4_NY': {'Quarter': 3, 'Week': 29, 'Day': 4, 'Session': 'NY'}, 'Q2_W15_D4_Asia': {'Quarter': 2, 'Week': 15, 'Day': 4, 'Session': 'Asia'}, 'Q1_W9_D7_Asia': {'Quarter': 1, 'Week': 9, 'Day': 7, 'Session': 'Asia'}, 'Q3_W38_D4_London': {'Quarter': 3, 'Week': 38, 'Day': 4, 'Session': 'London'}, 'Q1_W4_D4_London': {'Quarter': 1, 'Week': 4, 'Day': 4, 'Session': 'London'}, 'Q1_W3_D3_London': {'Quarter': 1, 'Week': 3, 'Day': 3, 'Session': 'London'}, 'Q2_W14_D4_London': {'Quarter': 2, 'Week': 14, 'Day': 4, 'Session': 'London'}, 'Q3_W39_D2_Asia': {'Quarter': 3, 'Week': 39, 'Day': 2, 'Session': 'Asia'}, 'Q3_W30_D1_London': {'Quarter': 3, 'Week': 30, 'Day': 1, 'Session': 'London'}, 'Q4_W43_D2_Asia': {'Quarter': 4, 'Week': 43, 'Day': 2, 'Session': 'Asia'}, 'Q4_W43_D1_Asia': {'Quarter': 4, 'Week': 43, 'Day': 1, 'Session': 'Asia'}, 'Q4_W52_D5_NY': {'Quarter': 4, 'Week': 52, 'Day': 5, 'Session': 'NY'}, 'Q3_W31_D4_Asia': {'Quarter': 3, 'Week': 31, 'Day': 4, 'Session': 'Asia'}, 'Q4_W47_D5_London': {'Quarter': 4, 'Week': 47, 'Day': 5, 'Session': 'London'}, 'Q2_W17_D3_Asia': {'Quarter': 2, 'Week': 17, 'Day': 3, 'Session': 'Asia'}, 'Q3_W32_D1_Asia': {'Quarter': 3, 'Week': 32, 'Day': 1, 'Session': 'Asia'}, 'Q1_W4_D2_Asia': {'Quarter': 1, 'Week': 4, 'Day': 2, 'Session': 'Asia'}, 'Q1_W10_D4_London': {'Quarter': 1, 'Week': 10, 'Day': 4, 'Session': 'London'}, 'Q2_W20_D3_London': {'Quarter': 2, 'Week': 20, 'Day': 3, 'Session': 'London'}, 'Q3_W37_D1_London': {'Quarter': 3, 'Week': 37, 'Day': 1, 'Session': 'London'}, 'Q2_W23_D3_Asia': {'Quarter': 2, 'Week': 23, 'Day': 3, 'Session': 'Asia'}, 'Q1_W7_D1_NY': {'Quarter': 1, 'Week': 7, 'Day': 1, 'Session': 'NY'}, 'Q2_W26_D2_NY': {'Quarter': 2, 'Week': 26, 'Day': 2, 'Session': 'NY'}, 'Q1_W3_D5_NY': {'Quarter': 1, 'Week': 3, 'Day': 5, 'Session': 'NY'}, 'Q1_W8_D5_London': {'Quarter': 1, 'Week': 8, 'Day': 5, 'Session': 'London'}, 'Q3_W32_D2_NY': {'Quarter': 3, 'Week': 32, 'Day': 2, 'Session': 'NY'}, 'Q2_W18_D2_Asia': {'Quarter': 2, 'Week': 18, 'Day': 2, 'Session': 'Asia'}, 'Q4_W51_D1_Asia': {'Quarter': 4, 'Week': 51, 'Day': 1, 'Session': 'Asia'}, 'Q4_W52_D5_London': {'Quarter': 4, 'Week': 52, 'Day': 5, 'Session': 'London'}, 'Q1_W12_D3_Asia': {'Quarter': 1, 'Week': 12, 'Day': 3, 'Session': 'Asia'}, 'Q1_W9_D1_Asia': {'Quarter': 1, 'Week': 9, 'Day': 1, 'Session': 'Asia'}, 'Q3_W35_D3_Asia': {'Quarter': 3, 'Week': 35, 'Day': 3, 'Session': 'Asia'}, 'Q3_W34_D1_Asia': {'Quarter': 3, 'Week': 34, 'Day': 1, 'Session': 'Asia'}, 'Q3_W31_D1_Asia': {'Quarter': 3, 'Week': 31, 'Day': 1, 'Session': 'Asia'}, 'Q3_W29_D1_Asia': {'Quarter': 3, 'Week': 29, 'Day': 1, 'Session': 'Asia'}, 'Q1_W12_D2_London': {'Quarter': 1, 'Week': 12, 'Day': 2, 'Session': 'London'}, 'Q3_W29_D2_NY': {'Quarter': 3, 'Week': 29, 'Day': 2, 'Session': 'NY'}, 'Q4_W40_D5_London': {'Quarter': 4, 'Week': 40, 'Day': 5, 'Session': 'London'}, 'Q3_W30_D3_NY': {'Quarter': 3, 'Week': 30, 'Day': 3, 'Session': 'NY'}, 'Q4_W47_D4_London': {'Quarter': 4, 'Week': 47, 'Day': 4, 'Session': 'London'}, 'Q2_W21_D3_London': {'Quarter': 2, 'Week': 21, 'Day': 3, 'Session': 'London'}, 'Q3_W32_D2_London': {'Quarter': 3, 'Week': 32, 'Day': 2, 'Session': 'London'}, 'Q4_W42_D7_Asia': {'Quarter': 4, 'Week': 42, 'Day': 7, 'Session': 'Asia'}, 'Q4_W45_D3_NY': {'Quarter': 4, 'Week': 45, 'Day': 3, 'Session': 'NY'}, 'Q2_W15_D5_NY': {'Quarter': 2, 'Week': 15, 'Day': 5, 'Session': 'NY'}, 'Q1_W12_D1_Asia': {'Quarter': 1, 'Week': 12, 'Day': 1, 'Session': 'Asia'}, 'Q3_W39_D3_Asia': {'Quarter': 3, 'Week': 39, 'Day': 3, 'Session': 'Asia'}, 'Q4_W47_D2_London': {'Quarter': 4, 'Week': 47, 'Day': 2, 'Session': 'London'}, 'Q2_W22_D5_NY': {'Quarter': 2, 'Week': 22, 'Day': 5, 'Session': 'NY'}, 'Q3_W30_D1_NY': {'Quarter': 3, 'Week': 30, 'Day': 1, 'Session': 'NY'}, 'Q4_W46_D5_London': {'Quarter': 4, 'Week': 46, 'Day': 5, 'Session': 'London'}, 'Q3_W32_D3_NY': {'Quarter': 3, 'Week': 32, 'Day': 3, 'Session': 'NY'}, 'Q1_W4_D4_NY': {'Quarter': 1, 'Week': 4, 'Day': 4, 'Session': 'NY'}, 'Q1_W3_D4_London': {'Quarter': 1, 'Week': 3, 'Day': 4, 'Session': 'London'}, 'Q4_W42_D5_Asia': {'Quarter': 4, 'Week': 42, 'Day': 5, 'Session': 'Asia'}, 'Q4_W51_D5_Asia': {'Quarter': 4, 'Week': 51, 'Day': 5, 'Session': 'Asia'}, 'Q4_W44_D1_Asia': {'Quarter': 4, 'Week': 44, 'Day': 1, 'Session': 'Asia'}, 'Q3_W31_D4_NY': {'Quarter': 3, 'Week': 31, 'Day': 4, 'Session': 'NY'}, 'Q3_W27_D2_London': {'Quarter': 3, 'Week': 27, 'Day': 2, 'Session': 'London'}, 'Q4_W46_D5_Asia': {'Quarter': 4, 'Week': 46, 'Day': 5, 'Session': 'Asia'}, 'Q4_W48_D5_London': {'Quarter': 4, 'Week': 48, 'Day': 5, 'Session': 'London'}, 'Q3_W39_D2_NY': {'Quarter': 3, 'Week': 39, 'Day': 2, 'Session': 'NY'}, 'Q1_W6_D3_NY': {'Quarter': 1, 'Week': 6, 'Day': 3, 'Session': 'NY'}, 'Q3_W33_D4_NY': {'Quarter': 3, 'Week': 33, 'Day': 4, 'Session': 'NY'}, 'Q3_W33_D1_Asia': {'Quarter': 3, 'Week': 33, 'Day': 1, 'Session': 'Asia'}, 'Q4_W1_D1_London': {'Quarter': 4, 'Week': 1, 'Day': 1, 'Session': 'London'}, 'Q3_W36_D5_London': {'Quarter': 3, 'Week': 36, 'Day': 5, 'Session': 'London'}, 'Q3_W33_D3_London': {'Quarter': 3, 'Week': 33, 'Day': 3, 'Session': 'London'}, 'Q2_W22_D4_NY': {'Quarter': 2, 'Week': 22, 'Day': 4, 'Session': 'NY'}, 'Q3_W38_D3_Asia': {'Quarter': 3, 'Week': 38, 'Day': 3, 'Session': 'Asia'}, 'Q4_W51_D4_London': {'Quarter': 4, 'Week': 51, 'Day': 4, 'Session': 'London'}, 'Q3_W32_D2_Asia': {'Quarter': 3, 'Week': 32, 'Day': 2, 'Session': 'Asia'}, 'Q3_W35_D2_NY': {'Quarter': 3, 'Week': 35, 'Day': 2, 'Session': 'NY'}, 'Q3_W34_D5_London': {'Quarter': 3, 'Week': 34, 'Day': 5, 'Session': 'London'}, 'Q2_W14_D1_London': {'Quarter': 2, 'Week': 14, 'Day': 1, 'Session': 'London'}, 'Q4_W44_D5_London': {'Quarter': 4, 'Week': 44, 'Day': 5, 'Session': 'London'}, 'Q1_W9_D5_NY': {'Quarter': 1, 'Week': 9, 'Day': 5, 'Session': 'NY'}, 'Q2_W25_D4_NY': {'Quarter': 2, 'Week': 25, 'Day': 4, 'Session': 'NY'}, 'Q1_W2_D2_London': {'Quarter': 1, 'Week': 2, 'Day': 2, 'Session': 'London'}, 'Q1_W5_D5_NY': {'Quarter': 1, 'Week': 5, 'Day': 5, 'Session': 'NY'}, 'Q2_W18_D1_Asia': {'Quarter': 2, 'Week': 18, 'Day': 1, 'Session': 'Asia'}, 'Q3_W30_D5_London': {'Quarter': 3, 'Week': 30, 'Day': 5, 'Session': 'London'}, 'Q2_W16_D4_Asia': {'Quarter': 2, 'Week': 16, 'Day': 4, 'Session': 'Asia'}, 'Q3_W27_D5_NY': {'Quarter': 3, 'Week': 27, 'Day': 5, 'Session': 'NY'}, 'Q3_W36_D4_NY': {'Quarter': 3, 'Week': 36, 'Day': 4, 'Session': 'NY'}, 'Q2_W20_D3_NY': {'Quarter': 2, 'Week': 20, 'Day': 3, 'Session': 'NY'}, 'Q2_W17_D2_NY': {'Quarter': 2, 'Week': 17, 'Day': 2, 'Session': 'NY'}, 'Q2_W21_D7_Asia': {'Quarter': 2, 'Week': 21, 'Day': 7, 'Session': 'Asia'}, 'Q2_W23_D3_NY': {'Quarter': 2, 'Week': 23, 'Day': 3, 'Session': 'NY'}, 'Q3_W35_D5_NY': {'Quarter': 3, 'Week': 35, 'Day': 5, 'Session': 'NY'}, 'Q2_W17_D4_Asia': {'Quarter': 2, 'Week': 17, 'Day': 4, 'Session': 'Asia'}, 'Q1_W10_D1_NY': {'Quarter': 1, 'Week': 10, 'Day': 1, 'Session': 'NY'}, 'Q1_W9_D2_Asia': {'Quarter': 1, 'Week': 9, 'Day': 2, 'Session': 'Asia'}, 'Q2_W19_D1_London': {'Quarter': 2, 'Week': 19, 'Day': 1, 'Session': 'London'}, 'Q2_W16_D3_NY': {'Quarter': 2, 'Week': 16, 'Day': 3, 'Session': 'NY'}, 'Q2_W16_D1_NY': {'Quarter': 2, 'Week': 16, 'Day': 1, 'Session': 'NY'}, 'Q1_W7_D4_London': {'Quarter': 1, 'Week': 7, 'Day': 4, 'Session': 'London'}, 'Q1_W6_D1_Asia': {'Quarter': 1, 'Week': 6, 'Day': 1, 'Session': 'Asia'}, 'Q3_W34_D3_London': {'Quarter': 3, 'Week': 34, 'Day': 3, 'Session': 'London'}, 'Q2_W23_D1_Asia': {'Quarter': 2, 'Week': 23, 'Day': 1, 'Session': 'Asia'}, 'Q1_W1_D5_London': {'Quarter': 1, 'Week': 1, 'Day': 5, 'Session': 'London'}, 'Q2_W14_D5_NY': {'Quarter': 2, 'Week': 14, 'Day': 5, 'Session': 'NY'}, 'Q1_W5_D1_London': {'Quarter': 1, 'Week': 5, 'Day': 1, 'Session': 'London'}, 'Q3_W27_D4_NY': {'Quarter': 3, 'Week': 27, 'Day': 4, 'Session': 'NY'}, 'Q1_W9_D5_London': {'Quarter': 1, 'Week': 9, 'Day': 5, 'Session': 'London'}, 'Q1_W7_D5_London': {'Quarter': 1, 'Week': 7, 'Day': 5, 'Session': 'London'}, 'Q4_W41_D1_Asia': {'Quarter': 4, 'Week': 41, 'Day': 1, 'Session': 'Asia'}, 'Q2_W20_D2_Asia': {'Quarter': 2, 'Week': 20, 'Day': 2, 'Session': 'Asia'}, 'Q4_W46_D4_NY': {'Quarter': 4, 'Week': 46, 'Day': 4, 'Session': 'NY'}, 'Q2_W14_D2_London': {'Quarter': 2, 'Week': 14, 'Day': 2, 'Session': 'London'}, 'Q4_W40_D2_Asia': {'Quarter': 4, 'Week': 40, 'Day': 2, 'Session': 'Asia'}, 'Q2_W26_D5_NY': {'Quarter': 2, 'Week': 26, 'Day': 5, 'Session': 'NY'}, 'Q2_W15_D5_London': {'Quarter': 2, 'Week': 15, 'Day': 5, 'Session': 'London'}, 'Q2_W18_D4_London': {'Quarter': 2, 'Week': 18, 'Day': 4, 'Session': 'London'}, 'Q4_W42_D4_Asia': {'Quarter': 4, 'Week': 42, 'Day': 4, 'Session': 'Asia'}, 'Q1_W13_D3_Asia': {'Quarter': 1, 'Week': 13, 'Day': 3, 'Session': 'Asia'}, 'Q3_W28_D1_London': {'Quarter': 3, 'Week': 28, 'Day': 1, 'Session': 'London'}, 'Q1_W3_D3_Asia': {'Quarter': 1, 'Week': 3, 'Day': 3, 'Session': 'Asia'}, 'Q1_W6_D3_Asia': {'Quarter': 1, 'Week': 6, 'Day': 3, 'Session': 'Asia'}, 'Q3_W30_D4_Asia': {'Quarter': 3, 'Week': 30, 'Day': 4, 'Session': 'Asia'}, 'Q4_W52_D2_London': {'Quarter': 4, 'Week': 52, 'Day': 2, 'Session': 'London'}, 'Q2_W21_D2_NY': {'Quarter': 2, 'Week': 21, 'Day': 2, 'Session': 'NY'}, 'Q2_W14_D4_Asia': {'Quarter': 2, 'Week': 14, 'Day': 4, 'Session': 'Asia'}, 'Q3_W35_D3_London': {'Quarter': 3, 'Week': 35, 'Day': 3, 'Session': 'London'}, 'Q1_W13_D1_Asia': {'Quarter': 1, 'Week': 13, 'Day': 1, 'Session': 'Asia'}, 'Q4_W45_D4_NY': {'Quarter': 4, 'Week': 45, 'Day': 4, 'Session': 'NY'}, 'Q3_W40_D2_NY': {'Quarter': 3, 'Week': 40, 'Day': 2, 'Session': 'NY'}, 'Q4_W51_D2_Asia': {'Quarter': 4, 'Week': 51, 'Day': 2, 'Session': 'Asia'}, 'Q4_W41_D2_London': {'Quarter': 4, 'Week': 41, 'Day': 2, 'Session': 'London'}, 'Q3_W34_D4_London': {'Quarter': 3, 'Week': 34, 'Day': 4, 'Session': 'London'}, 'Q1_W7_D4_NY': {'Quarter': 1, 'Week': 7, 'Day': 4, 'Session': 'NY'}, 'Q1_W6_D2_Asia': {'Quarter': 1, 'Week': 6, 'Day': 2, 'Session': 'Asia'}, 'Q4_W48_D2_NY': {'Quarter': 4, 'Week': 48, 'Day': 2, 'Session': 'NY'}, 'Q3_W31_D3_NY': {'Quarter': 3, 'Week': 31, 'Day': 3, 'Session': 'NY'}, 'Q2_W17_D4_London': {'Quarter': 2, 'Week': 17, 'Day': 4, 'Session': 'London'}, 'Q1_W8_D4_NY': {'Quarter': 1, 'Week': 8, 'Day': 4, 'Session': 'NY'}, 'Q1_W1_D4_NY': {'Quarter': 1, 'Week': 1, 'Day': 4, 'Session': 'NY'}, 'Q4_W42_D1_NY': {'Quarter': 4, 'Week': 42, 'Day': 1, 'Session': 'NY'}, 'Q4_W45_D5_London': {'Quarter': 4, 'Week': 45, 'Day': 5, 'Session': 'London'}, 'Q2_W26_D4_Asia': {'Quarter': 2, 'Week': 26, 'Day': 4, 'Session': 'Asia'}, 'Q4_W45_D3_Asia': {'Quarter': 4, 'Week': 45, 'Day': 3, 'Session': 'Asia'}, 'Q1_W8_D3_London': {'Quarter': 1, 'Week': 8, 'Day': 3, 'Session': 'London'}, 'Q3_W28_D5_London': {'Quarter': 3, 'Week': 28, 'Day': 5, 'Session': 'London'}, 'Q1_W5_D4_NY': {'Quarter': 1, 'Week': 5, 'Day': 4, 'Session': 'NY'}, 'Q2_W20_D2_NY': {'Quarter': 2, 'Week': 20, 'Day': 2, 'Session': 'NY'}, 'Q1_W11_D2_London': {'Quarter': 1, 'Week': 11, 'Day': 2, 'Session': 'London'}, 'Q3_W30_D1_Asia': {'Quarter': 3, 'Week': 30, 'Day': 1, 'Session': 'Asia'}, 'Q3_W35_D4_NY': {'Quarter': 3, 'Week': 35, 'Day': 4, 'Session': 'NY'}, 'Q2_W17_D4_NY': {'Quarter': 2, 'Week': 17, 'Day': 4, 'Session': 'NY'}, 'Q4_W43_D4_London': {'Quarter': 4, 'Week': 43, 'Day': 4, 'Session': 'London'}, 'Q3_W39_D3_NY': {'Quarter': 3, 'Week': 39, 'Day': 3, 'Session': 'NY'}, 'Q1_W8_D4_Asia': {'Quarter': 1, 'Week': 8, 'Day': 4, 'Session': 'Asia'}, 'Q2_W24_D5_NY': {'Quarter': 2, 'Week': 24, 'Day': 5, 'Session': 'NY'}, 'Q2_W22_D2_NY': {'Quarter': 2, 'Week': 22, 'Day': 2, 'Session': 'NY'}, 'Q4_W42_D3_London': {'Quarter': 4, 'Week': 42, 'Day': 3, 'Session': 'London'}, 'Q2_W23_D4_NY': {'Quarter': 2, 'Week': 23, 'Day': 4, 'Session': 'NY'}, 'Q2_W25_D1_London': {'Quarter': 2, 'Week': 25, 'Day': 1, 'Session': 'London'}, 'Q2_W25_D1_NY': {'Quarter': 2, 'Week': 25, 'Day': 1, 'Session': 'NY'}, 'Q4_W51_D5_London': {'Quarter': 4, 'Week': 51, 'Day': 5, 'Session': 'London'}, 'Q4_W41_D3_NY': {'Quarter': 4, 'Week': 41, 'Day': 3, 'Session': 'NY'}, 'Q4_W51_D2_NY': {'Quarter': 4, 'Week': 51, 'Day': 2, 'Session': 'NY'}, 'Q4_W51_D3_NY': {'Quarter': 4, 'Week': 51, 'Day': 3, 'Session': 'NY'}, 'Q3_W38_D2_NY': {'Quarter': 3, 'Week': 38, 'Day': 2, 'Session': 'NY'}, 'Q2_W25_D3_Asia': {'Quarter': 2, 'Week': 25, 'Day': 3, 'Session': 'Asia'}, 'Q1_W4_D3_NY': {'Quarter': 1, 'Week': 4, 'Day': 3, 'Session': 'NY'}, 'Q4_W50_D2_London': {'Quarter': 4, 'Week': 50, 'Day': 2, 'Session': 'London'}, 'Q4_W41_D1_NY': {'Quarter': 4, 'Week': 41, 'Day': 1, 'Session': 'NY'}, 'Q1_W12_D1_London': {'Quarter': 1, 'Week': 12, 'Day': 1, 'Session': 'London'}, 'Q4_W42_D1_Asia': {'Quarter': 4, 'Week': 42, 'Day': 1, 'Session': 'Asia'}, 'Q4_W49_D3_NY': {'Quarter': 4, 'Week': 49, 'Day': 3, 'Session': 'NY'}, 'Q1_W2_D4_NY': {'Quarter': 1, 'Week': 2, 'Day': 4, 'Session': 'NY'}, 'Q3_W39_D1_NY': {'Quarter': 3, 'Week': 39, 'Day': 1, 'Session': 'NY'}, 'Q2_W14_D4_NY': {'Quarter': 2, 'Week': 14, 'Day': 4, 'Session': 'NY'}, 'Q1_W9_D4_NY': {'Quarter': 1, 'Week': 9, 'Day': 4, 'Session': 'NY'}, 'Q1_W5_D1_Asia': {'Quarter': 1, 'Week': 5, 'Day': 1, 'Session': 'Asia'}, 'Q2_W26_D4_London': {'Quarter': 2, 'Week': 26, 'Day': 4, 'Session': 'London'}, 'Q4_W44_D4_Asia': {'Quarter': 4, 'Week': 44, 'Day': 4, 'Session': 'Asia'}, 'Q1_W9_D1_NY': {'Quarter': 1, 'Week': 9, 'Day': 1, 'Session': 'NY'}, 'Q2_W24_D1_NY': {'Quarter': 2, 'Week': 24, 'Day': 1, 'Session': 'NY'}, 'Q2_W24_D4_NY': {'Quarter': 2, 'Week': 24, 'Day': 4, 'Session': 'NY'}, 'Q4_W40_D7_Asia': {'Quarter': 4, 'Week': 40, 'Day': 7, 'Session': 'Asia'}, 'Q4_W47_D1_NY': {'Quarter': 4, 'Week': 47, 'Day': 1, 'Session': 'NY'}, 'Q4_W40_D3_London': {'Quarter': 4, 'Week': 40, 'Day': 3, 'Session': 'London'}, 'Q2_W24_D2_London': {'Quarter': 2, 'Week': 24, 'Day': 2, 'Session': 'London'}, 'Q1_W11_D1_London': {'Quarter': 1, 'Week': 11, 'Day': 1, 'Session': 'London'}, 'Q4_W46_D2_NY': {'Quarter': 4, 'Week': 46, 'Day': 2, 'Session': 'NY'}, 'Q4_W51_D3_London': {'Quarter': 4, 'Week': 51, 'Day': 3, 'Session': 'London'}, 'Q4_W41_D7_Asia': {'Quarter': 4, 'Week': 41, 'Day': 7, 'Session': 'Asia'}, 'Q4_W41_D4_Asia': {'Quarter': 4, 'Week': 41, 'Day': 4, 'Session': 'Asia'}, 'Q1_W2_D5_NY': {'Quarter': 1, 'Week': 2, 'Day': 5, 'Session': 'NY'}, 'Q3_W34_D4_Asia': {'Quarter': 3, 'Week': 34, 'Day': 4, 'Session': 'Asia'}, 'Q4_W42_D4_London': {'Quarter': 4, 'Week': 42, 'Day': 4, 'Session': 'London'}, 'Q4_W45_D2_NY': {'Quarter': 4, 'Week': 45, 'Day': 2, 'Session': 'NY'}, 'Q1_W11_D3_London': {'Quarter': 1, 'Week': 11, 'Day': 3, 'Session': 'London'}, 'Q4_W42_D5_NY': {'Quarter': 4, 'Week': 42, 'Day': 5, 'Session': 'NY'}, 'Q1_W12_D5_NY': {'Quarter': 1, 'Week': 12, 'Day': 5, 'Session': 'NY'}, 'Q1_W10_D1_London': {'Quarter': 1, 'Week': 10, 'Day': 1, 'Session': 'London'}, 'Q3_W28_D4_NY': {'Quarter': 3, 'Week': 28, 'Day': 4, 'Session': 'NY'}, 'Q2_W19_D1_NY': {'Quarter': 2, 'Week': 19, 'Day': 1, 'Session': 'NY'}, 'Q2_W15_D4_NY': {'Quarter': 2, 'Week': 15, 'Day': 4, 'Session': 'NY'}, 'Q1_W13_D2_London': {'Quarter': 1, 'Week': 13, 'Day': 2, 'Session': 'London'}, 'Q4_W41_D3_Asia': {'Quarter': 4, 'Week': 41, 'Day': 3, 'Session': 'Asia'}, 'Q4_W46_D1_Asia': {'Quarter': 4, 'Week': 46, 'Day': 1, 'Session': 'Asia'}, 'Q4_W48_D3_London': {'Quarter': 4, 'Week': 48, 'Day': 3, 'Session': 'London'}, 'Q3_W34_D2_NY': {'Quarter': 3, 'Week': 34, 'Day': 2, 'Session': 'NY'}, 'Q2_W16_D4_NY': {'Quarter': 2, 'Week': 16, 'Day': 4, 'Session': 'NY'}, 'Q2_W23_D3_London': {'Quarter': 2, 'Week': 23, 'Day': 3, 'Session': 'London'}, 'Q3_W27_D3_London': {'Quarter': 3, 'Week': 27, 'Day': 3, 'Session': 'London'}, 'Q1_W11_D4_NY': {'Quarter': 1, 'Week': 11, 'Day': 4, 'Session': 'NY'}, 'Q2_W17_D5_London': {'Quarter': 2, 'Week': 17, 'Day': 5, 'Session': 'London'}, 'Q4_W44_D2_NY': {'Quarter': 4, 'Week': 44, 'Day': 2, 'Session': 'NY'}, 'Q4_W42_D2_NY': {'Quarter': 4, 'Week': 42, 'Day': 2, 'Session': 'NY'}, 'Q2_W17_D1_NY': {'Quarter': 2, 'Week': 17, 'Day': 1, 'Session': 'NY'}, 'Q3_W32_D1_NY': {'Quarter': 3, 'Week': 32, 'Day': 1, 'Session': 'NY'}, 'Q4_W49_D2_London': {'Quarter': 4, 'Week': 49, 'Day': 2, 'Session': 'London'}, 'Q4_W47_D2_NY': {'Quarter': 4, 'Week': 47, 'Day': 2, 'Session': 'NY'}, 'Q2_W20_D5_NY': {'Quarter': 2, 'Week': 20, 'Day': 5, 'Session': 'NY'}, 'Q1_W11_D5_NY': {'Quarter': 1, 'Week': 11, 'Day': 5, 'Session': 'NY'}, 'Q3_W38_D3_NY': {'Quarter': 3, 'Week': 38, 'Day': 3, 'Session': 'NY'}, 'Q4_W44_D1_NY': {'Quarter': 4, 'Week': 44, 'Day': 1, 'Session': 'NY'}, 'Q1_W11_D4_Asia': {'Quarter': 1, 'Week': 11, 'Day': 4, 'Session': 'Asia'}, 'Q4_W48_D3_NY': {'Quarter': 4, 'Week': 48, 'Day': 3, 'Session': 'NY'}, 'Q1_W2_D2_NY': {'Quarter': 1, 'Week': 2, 'Day': 2, 'Session': 'NY'}, 'Q3_W32_D3_Asia': {'Quarter': 3, 'Week': 32, 'Day': 3, 'Session': 'Asia'}, 'Q3_W37_D1_NY': {'Quarter': 3, 'Week': 37, 'Day': 1, 'Session': 'NY'}, 'Q3_W27_D1_NY': {'Quarter': 3, 'Week': 27, 'Day': 1, 'Session': 'NY'}, 'Q2_W23_D5_London': {'Quarter': 2, 'Week': 23, 'Day': 5, 'Session': 'London'}, 'Q1_W9_D3_Asia': {'Quarter': 1, 'Week': 9, 'Day': 3, 'Session': 'Asia'}, 'Q1_W13_D3_NY': {'Quarter': 1, 'Week': 13, 'Day': 3, 'Session': 'NY'}, 'Q2_W23_D2_London': {'Quarter': 2, 'Week': 23, 'Day': 2, 'Session': 'London'}, 'Q3_W36_D4_Asia': {'Quarter': 3, 'Week': 36, 'Day': 4, 'Session': 'Asia'}, 'Q1_W12_D2_NY': {'Quarter': 1, 'Week': 12, 'Day': 2, 'Session': 'NY'}, 'Q2_W14_D5_London': {'Quarter': 2, 'Week': 14, 'Day': 5, 'Session': 'London'}, 'Q2_W19_D4_Asia': {'Quarter': 2, 'Week': 19, 'Day': 4, 'Session': 'Asia'}, 'Q4_W52_D1_London': {'Quarter': 4, 'Week': 52, 'Day': 1, 'Session': 'London'}, 'Q1_W3_D1_London': {'Quarter': 1, 'Week': 3, 'Day': 1, 'Session': 'London'}, 'Q4_W45_D4_Asia': {'Quarter': 4, 'Week': 45, 'Day': 4, 'Session': 'Asia'}, 'Q2_W20_D4_NY': {'Quarter': 2, 'Week': 20, 'Day': 4, 'Session': 'NY'}, 'Q1_W5_D5_Asia': {'Quarter': 1, 'Week': 5, 'Day': 5, 'Session': 'Asia'}, 'Q1_W11_D7_Asia': {'Quarter': 1, 'Week': 11, 'Day': 7, 'Session': 'Asia'}, 'Q1_W7_D2_Asia': {'Quarter': 1, 'Week': 7, 'Day': 2, 'Session': 'Asia'}, 'Q4_W52_D4_London': {'Quarter': 4, 'Week': 52, 'Day': 4, 'Session': 'London'}, 'Q2_W27_D1_NY': {'Quarter': 2, 'Week': 27, 'Day': 1, 'Session': 'NY'}, 'Q2_W17_D5_NY': {'Quarter': 2, 'Week': 17, 'Day': 5, 'Session': 'NY'}, 'Q1_W10_D3_NY': {'Quarter': 1, 'Week': 10, 'Day': 3, 'Session': 'NY'}, 'Q4_W40_D5_NY': {'Quarter': 4, 'Week': 40, 'Day': 5, 'Session': 'NY'}, 'Q1_W5_D2_NY': {'Quarter': 1, 'Week': 5, 'Day': 2, 'Session': 'NY'}, 'Q1_W11_D2_NY': {'Quarter': 1, 'Week': 11, 'Day': 2, 'Session': 'NY'}, 'Q2_W19_D4_London': {'Quarter': 2, 'Week': 19, 'Day': 4, 'Session': 'London'}, 'Q1_W10_D5_NY': {'Quarter': 1, 'Week': 10, 'Day': 5, 'Session': 'NY'}, 'Q3_W31_D1_NY': {'Quarter': 3, 'Week': 31, 'Day': 1, 'Session': 'NY'}, 'Q1_W3_D3_NY': {'Quarter': 1, 'Week': 3, 'Day': 3, 'Session': 'NY'}, 'Q2_W14_D5_Asia': {'Quarter': 2, 'Week': 14, 'Day': 5, 'Session': 'Asia'}, 'Q1_W9_D2_NY': {'Quarter': 1, 'Week': 9, 'Day': 2, 'Session': 'NY'}, 'Q1_W2_D4_London': {'Quarter': 1, 'Week': 2, 'Day': 4, 'Session': 'London'}, 'Q3_W32_D3_London': {'Quarter': 3, 'Week': 32, 'Day': 3, 'Session': 'London'}, 'Q3_W33_D4_London': {'Quarter': 3, 'Week': 33, 'Day': 4, 'Session': 'London'}, 'Q2_W17_D2_Asia': {'Quarter': 2, 'Week': 17, 'Day': 2, 'Session': 'Asia'}, 'Q4_W40_D4_NY': {'Quarter': 4, 'Week': 40, 'Day': 4, 'Session': 'NY'}, 'Q2_W20_D4_London': {'Quarter': 2, 'Week': 20, 'Day': 4, 'Session': 'London'}, 'Q1_W12_D4_London': {'Quarter': 1, 'Week': 12, 'Day': 4, 'Session': 'London'}, 'Q2_W26_D4_NY': {'Quarter': 2, 'Week': 26, 'Day': 4, 'Session': 'NY'}, 'Q4_W49_D1_London': {'Quarter': 4, 'Week': 49, 'Day': 1, 'Session': 'London'}, 'Q3_W28_D5_NY': {'Quarter': 3, 'Week': 28, 'Day': 5, 'Session': 'NY'}, 'Q2_W21_D1_Asia': {'Quarter': 2, 'Week': 21, 'Day': 1, 'Session': 'Asia'}, 'Q3_W39_D4_Asia': {'Quarter': 3, 'Week': 39, 'Day': 4, 'Session': 'Asia'}, 'Q3_W37_D4_London': {'Quarter': 3, 'Week': 37, 'Day': 4, 'Session': 'London'}, 'Q1_W5_D1_NY': {'Quarter': 1, 'Week': 5, 'Day': 1, 'Session': 'NY'}, 'Q4_W43_D3_London': {'Quarter': 4, 'Week': 43, 'Day': 3, 'Session': 'London'}, 'Q1_W12_D4_Asia': {'Quarter': 1, 'Week': 12, 'Day': 4, 'Session': 'Asia'}, 'Q4_W46_D1_NY': {'Quarter': 4, 'Week': 46, 'Day': 1, 'Session': 'NY'}, 'Q4_W48_D4_NY': {'Quarter': 4, 'Week': 48, 'Day': 4, 'Session': 'NY'}, 'Q3_W33_D2_Asia': {'Quarter': 3, 'Week': 33, 'Day': 2, 'Session': 'Asia'}, 'Q2_W26_D3_London': {'Quarter': 2, 'Week': 26, 'Day': 3, 'Session': 'London'}, 'Q3_W30_D3_London': {'Quarter': 3, 'Week': 30, 'Day': 3, 'Session': 'London'}, 'Q1_W10_D4_NY': {'Quarter': 1, 'Week': 10, 'Day': 4, 'Session': 'NY'}, 'Q3_W31_D3_London': {'Quarter': 3, 'Week': 31, 'Day': 3, 'Session': 'London'}, 'Q2_W20_D1_NY': {'Quarter': 2, 'Week': 20, 'Day': 1, 'Session': 'NY'}, 'Q3_W33_D1_NY': {'Quarter': 3, 'Week': 33, 'Day': 1, 'Session': 'NY'}, 'Q3_W32_D5_London': {'Quarter': 3, 'Week': 32, 'Day': 5, 'Session': 'London'}, 'Q4_W41_D2_NY': {'Quarter': 4, 'Week': 41, 'Day': 2, 'Session': 'NY'}, 'Q3_W31_D2_London': {'Quarter': 3, 'Week': 31, 'Day': 2, 'Session': 'London'}, 'Q4_W48_D1_Asia': {'Quarter': 4, 'Week': 48, 'Day': 1, 'Session': 'Asia'}, 'Q4_W44_D4_NY': {'Quarter': 4, 'Week': 44, 'Day': 4, 'Session': 'NY'}, 'Q1_W13_D2_NY': {'Quarter': 1, 'Week': 13, 'Day': 2, 'Session': 'NY'}, 'Q2_W22_D3_London': {'Quarter': 2, 'Week': 22, 'Day': 3, 'Session': 'London'}, 'Q4_W40_D3_NY': {'Quarter': 4, 'Week': 40, 'Day': 3, 'Session': 'NY'}, 'Q2_W25_D3_London': {'Quarter': 2, 'Week': 25, 'Day': 3, 'Session': 'London'}, 'Q2_W23_D4_Asia': {'Quarter': 2, 'Week': 23, 'Day': 4, 'Session': 'Asia'}, 'Q4_W50_D4_NY': {'Quarter': 4, 'Week': 50, 'Day': 4, 'Session': 'NY'}, 'Q4_W48_D2_Asia': {'Quarter': 4, 'Week': 48, 'Day': 2, 'Session': 'Asia'}, 'Q3_W35_D5_London': {'Quarter': 3, 'Week': 35, 'Day': 5, 'Session': 'London'}, 'Q1_W9_D3_London': {'Quarter': 1, 'Week': 9, 'Day': 3, 'Session': 'London'}, 'Q4_W44_D4_London': {'Quarter': 4, 'Week': 44, 'Day': 4, 'Session': 'London'}, 'Q3_W39_D3_London': {'Quarter': 3, 'Week': 39, 'Day': 3, 'Session': 'London'}, 'Q1_W10_D3_London': {'Quarter': 1, 'Week': 10, 'Day': 3, 'Session': 'London'}, 'Q1_W8_D3_Asia': {'Quarter': 1, 'Week': 8, 'Day': 3, 'Session': 'Asia'}, 'Q4_W46_D5_NY': {'Quarter': 4, 'Week': 46, 'Day': 5, 'Session': 'NY'}, 'Q2_W19_D5_London': {'Quarter': 2, 'Week': 19, 'Day': 5, 'Session': 'London'}, 'Q2_W19_D3_Asia': {'Quarter': 2, 'Week': 19, 'Day': 3, 'Session': 'Asia'}, 'Q1_W7_D3_London': {'Quarter': 1, 'Week': 7, 'Day': 3, 'Session': 'London'}, 'Q4_W43_D2_London': {'Quarter': 4, 'Week': 43, 'Day': 2, 'Session': 'London'}, 'Q4_W43_D3_Asia': {'Quarter': 4, 'Week': 43, 'Day': 3, 'Session': 'Asia'}, 'Q2_W18_D5_NY': {'Quarter': 2, 'Week': 18, 'Day': 5, 'Session': 'NY'}, 'Q4_W43_D2_NY': {'Quarter': 4, 'Week': 43, 'Day': 2, 'Session': 'NY'}, 'Q4_W45_D1_London': {'Quarter': 4, 'Week': 45, 'Day': 1, 'Session': 'London'}, 'Q4_W47_D5_NY': {'Quarter': 4, 'Week': 47, 'Day': 5, 'Session': 'NY'}, 'Q4_W44_D5_NY': {'Quarter': 4, 'Week': 44, 'Day': 5, 'Session': 'NY'}, 'Q1_W9_D2_London': {'Quarter': 1, 'Week': 9, 'Day': 2, 'Session': 'London'}, 'Q2_W17_D1_Asia': {'Quarter': 2, 'Week': 17, 'Day': 1, 'Session': 'Asia'}, 'Q3_W38_D5_London': {'Quarter': 3, 'Week': 38, 'Day': 5, 'Session': 'London'}, 'Q4_W43_D1_NY': {'Quarter': 4, 'Week': 43, 'Day': 1, 'Session': 'NY'}, 'Q2_W25_D2_NY': {'Quarter': 2, 'Week': 25, 'Day': 2, 'Session': 'NY'}, 'Q2_W15_D3_London': {'Quarter': 2, 'Week': 15, 'Day': 3, 'Session': 'London'}, 'Q1_W4_D5_NY': {'Quarter': 1, 'Week': 4, 'Day': 5, 'Session': 'NY'}, 'Q1_W10_D7_Asia': {'Quarter': 1, 'Week': 10, 'Day': 7, 'Session': 'Asia'}, 'Q4_W47_D4_NY': {'Quarter': 4, 'Week': 47, 'Day': 4, 'Session': 'NY'}, 'Q2_W21_D1_NY': {'Quarter': 2, 'Week': 21, 'Day': 1, 'Session': 'NY'}, 'Q4_W52_D1_NY': {'Quarter': 4, 'Week': 52, 'Day': 1, 'Session': 'NY'}, 'Q2_W24_D3_Asia': {'Quarter': 2, 'Week': 24, 'Day': 3, 'Session': 'Asia'}, 'Q4_W47_D1_Asia': {'Quarter': 4, 'Week': 47, 'Day': 1, 'Session': 'Asia'}, 'Q1_W6_D5_NY': {'Quarter': 1, 'Week': 6, 'Day': 5, 'Session': 'NY'}, 'Q1_W11_D1_Asia': {'Quarter': 1, 'Week': 11, 'Day': 1, 'Session': 'Asia'}, 'Q4_W44_D3_London': {'Quarter': 4, 'Week': 44, 'Day': 3, 'Session': 'London'}, 'Q3_W39_D5_Asia': {'Quarter': 3, 'Week': 39, 'Day': 5, 'Session': 'Asia'}, 'Q3_W28_D3_NY': {'Quarter': 3, 'Week': 28, 'Day': 3, 'Session': 'NY'}, 'Q1_W6_D4_London': {'Quarter': 1, 'Week': 6, 'Day': 4, 'Session': 'London'}, 'Q3_W38_D1_NY': {'Quarter': 3, 'Week': 38, 'Day': 1, 'Session': 'NY'}, 'Q3_W29_D5_London': {'Quarter': 3, 'Week': 29, 'Day': 5, 'Session': 'London'}, 'Q2_W18_D5_London': {'Quarter': 2, 'Week': 18, 'Day': 5, 'Session': 'London'}, 'Q4_W46_D1_London': {'Quarter': 4, 'Week': 46, 'Day': 1, 'Session': 'London'}, 'Q2_W17_D2_London': {'Quarter': 2, 'Week': 17, 'Day': 2, 'Session': 'London'}, 'Q2_W21_D5_NY': {'Quarter': 2, 'Week': 21, 'Day': 5, 'Session': 'NY'}, 'Q1_W11_D3_Asia': {'Quarter': 1, 'Week': 11, 'Day': 3, 'Session': 'Asia'}, 'Q3_W29_D2_London': {'Quarter': 3, 'Week': 29, 'Day': 2, 'Session': 'London'}, 'Q4_W43_D3_NY': {'Quarter': 4, 'Week': 43, 'Day': 3, 'Session': 'NY'}, 'Q2_W17_D3_NY': {'Quarter': 2, 'Week': 17, 'Day': 3, 'Session': 'NY'}, 'Q2_W25_D1_Asia': {'Quarter': 2, 'Week': 25, 'Day': 1, 'Session': 'Asia'}, 'Q3_W30_D4_NY': {'Quarter': 3, 'Week': 30, 'Day': 4, 'Session': 'NY'}, 'Q3_W32_D7_Asia': {'Quarter': 3, 'Week': 32, 'Day': 7, 'Session': 'Asia'}, 'Q4_W40_D4_Asia': {'Quarter': 4, 'Week': 40, 'Day': 4, 'Session': 'Asia'}, 'Q4_W46_D2_London': {'Quarter': 4, 'Week': 46, 'Day': 2, 'Session': 'London'}, 'Q4_W49_D4_London': {'Quarter': 4, 'Week': 49, 'Day': 4, 'Session': 'London'}, 'Q3_W30_D2_NY': {'Quarter': 3, 'Week': 30, 'Day': 2, 'Session': 'NY'}, 'Q2_W15_D5_Asia': {'Quarter': 2, 'Week': 15, 'Day': 5, 'Session': 'Asia'}, 'Q4_W51_D1_NY': {'Quarter': 4, 'Week': 51, 'Day': 1, 'Session': 'NY'}, 'Q3_W31_D2_NY': {'Quarter': 3, 'Week': 31, 'Day': 2, 'Session': 'NY'}, 'Q2_W24_D3_NY': {'Quarter': 2, 'Week': 24, 'Day': 3, 'Session': 'NY'}, 'Q2_W15_D4_London': {'Quarter': 2, 'Week': 15, 'Day': 4, 'Session': 'London'}, 'Q3_W37_D5_NY': {'Quarter': 3, 'Week': 37, 'Day': 5, 'Session': 'NY'}, 'Q1_W7_D2_NY': {'Quarter': 1, 'Week': 7, 'Day': 2, 'Session': 'NY'}, 'Q1_W5_D4_London': {'Quarter': 1, 'Week': 5, 'Day': 4, 'Session': 'London'}, 'Q2_W18_D1_NY': {'Quarter': 2, 'Week': 18, 'Day': 1, 'Session': 'NY'}, 'Q1_W7_D3_Asia': {'Quarter': 1, 'Week': 7, 'Day': 3, 'Session': 'Asia'}, 'Q1_W13_D1_NY': {'Quarter': 1, 'Week': 13, 'Day': 1, 'Session': 'NY'}, 'Q4_W41_D5_NY': {'Quarter': 4, 'Week': 41, 'Day': 5, 'Session': 'NY'}, 'Q1_W2_D3_NY': {'Quarter': 1, 'Week': 2, 'Day': 3, 'Session': 'NY'}, 'Q1_W3_D1_Asia': {'Quarter': 1, 'Week': 3, 'Day': 1, 'Session': 'Asia'}, 'Q3_W32_D1_London': {'Quarter': 3, 'Week': 32, 'Day': 1, 'Session': 'London'}, 'Q3_W33_D2_London': {'Quarter': 3, 'Week': 33, 'Day': 2, 'Session': 'London'}, 'Q1_W8_D5_NY': {'Quarter': 1, 'Week': 8, 'Day': 5, 'Session': 'NY'}, 'Q2_W24_D4_Asia': {'Quarter': 2, 'Week': 24, 'Day': 4, 'Session': 'Asia'}, 'Q3_W36_D3_NY': {'Quarter': 3, 'Week': 36, 'Day': 3, 'Session': 'NY'}, 'Q3_W34_D1_London': {'Quarter': 3, 'Week': 34, 'Day': 1, 'Session': 'London'}, 'Q3_W37_D2_London': {'Quarter': 3, 'Week': 37, 'Day': 2, 'Session': 'London'}, 'Q3_W34_D4_NY': {'Quarter': 3, 'Week': 34, 'Day': 4, 'Session': 'NY'}, 'Q1_W1_D5_NY': {'Quarter': 1, 'Week': 1, 'Day': 5, 'Session': 'NY'}, 'Q4_W47_D3_Asia': {'Quarter': 4, 'Week': 47, 'Day': 3, 'Session': 'Asia'}, 'Q4_W41_D4_London': {'Quarter': 4, 'Week': 41, 'Day': 4, 'Session': 'London'}, 'Q4_W40_D1_NY': {'Quarter': 4, 'Week': 40, 'Day': 1, 'Session': 'NY'}, 'Q2_W14_D2_NY': {'Quarter': 2, 'Week': 14, 'Day': 2, 'Session': 'NY'}, 'Q3_W34_D3_Asia': {'Quarter': 3, 'Week': 34, 'Day': 3, 'Session': 'Asia'}, 'Q4_W48_D1_NY': {'Quarter': 4, 'Week': 48, 'Day': 1, 'Session': 'NY'}, 'Q3_W31_D4_London': {'Quarter': 3, 'Week': 31, 'Day': 4, 'Session': 'London'}, 'Q2_W15_D2_NY': {'Quarter': 2, 'Week': 15, 'Day': 2, 'Session': 'NY'}, 'Q3_W31_D5_London': {'Quarter': 3, 'Week': 31, 'Day': 5, 'Session': 'London'}, 'Q3_W39_D1_Asia': {'Quarter': 3, 'Week': 39, 'Day': 1, 'Session': 'Asia'}, 'Q3_W30_D5_NY': {'Quarter': 3, 'Week': 30, 'Day': 5, 'Session': 'NY'}, 'Q4_W43_D4_Asia': {'Quarter': 4, 'Week': 43, 'Day': 4, 'Session': 'Asia'}, 'Q3_W39_D5_NY': {'Quarter': 3, 'Week': 39, 'Day': 5, 'Session': 'NY'}, 'Q4_W49_D1_Asia': {'Quarter': 4, 'Week': 49, 'Day': 1, 'Session': 'Asia'}, 'Q1_W10_D5_London': {'Quarter': 1, 'Week': 10, 'Day': 5, 'Session': 'London'}, 'Q4_W49_D4_NY': {'Quarter': 4, 'Week': 49, 'Day': 4, 'Session': 'NY'}, 'Q1_W14_D1_Asia': {'Quarter': 1, 'Week': 14, 'Day': 1, 'Session': 'Asia'}, 'Q3_W33_D4_Asia': {'Quarter': 3, 'Week': 33, 'Day': 4, 'Session': 'Asia'}, 'Q4_W48_D5_NY': {'Quarter': 4, 'Week': 48, 'Day': 5, 'Session': 'NY'}, 'Q2_W14_D7_Asia': {'Quarter': 2, 'Week': 14, 'Day': 7, 'Session': 'Asia'}, 'Q3_W35_D1_London': {'Quarter': 3, 'Week': 35, 'Day': 1, 'Session': 'London'}, 'Q3_W36_D1_Asia': {'Quarter': 3, 'Week': 36, 'Day': 1, 'Session': 'Asia'}, 'Q1_W5_D2_London': {'Quarter': 1, 'Week': 5, 'Day': 2, 'Session': 'London'}, 'Q4_W44_D2_Asia': {'Quarter': 4, 'Week': 44, 'Day': 2, 'Session': 'Asia'}, 'Q3_W37_D3_NY': {'Quarter': 3, 'Week': 37, 'Day': 3, 'Session': 'NY'}, 'Q3_W34_D2_London': {'Quarter': 3, 'Week': 34, 'Day': 2, 'Session': 'London'}, 'Q4_W47_D5_Asia': {'Quarter': 4, 'Week': 47, 'Day': 5, 'Session': 'Asia'}, 'Q2_W14_D3_Asia': {'Quarter': 2, 'Week': 14, 'Day': 3, 'Session': 'Asia'}, 'Q1_W5_D3_London': {'Quarter': 1, 'Week': 5, 'Day': 3, 'Session': 'London'}, 'Q4_W40_D2_NY': {'Quarter': 4, 'Week': 40, 'Day': 2, 'Session': 'NY'}, 'Q4_W41_D4_NY': {'Quarter': 4, 'Week': 41, 'Day': 4, 'Session': 'NY'}, 'Q4_W50_D4_London': {'Quarter': 4, 'Week': 50, 'Day': 4, 'Session': 'London'}, 'Q1_W3_D4_NY': {'Quarter': 1, 'Week': 3, 'Day': 4, 'Session': 'NY'}, 'Q3_W36_D2_NY': {'Quarter': 3, 'Week': 36, 'Day': 2, 'Session': 'NY'}, 'Q1_W12_D4_NY': {'Quarter': 1, 'Week': 12, 'Day': 4, 'Session': 'NY'}, 'Q1_W2_D4_Asia': {'Quarter': 1, 'Week': 2, 'Day': 4, 'Session': 'Asia'}, 'Q3_W37_D5_London': {'Quarter': 3, 'Week': 37, 'Day': 5, 'Session': 'London'}, 'Q1_W8_D2_Asia': {'Quarter': 1, 'Week': 8, 'Day': 2, 'Session': 'Asia'}, 'Q4_W41_D5_London': {'Quarter': 4, 'Week': 41, 'Day': 5, 'Session': 'London'}, 'Q3_W32_D4_Asia': {'Quarter': 3, 'Week': 32, 'Day': 4, 'Session': 'Asia'}, 'Q2_W23_D2_NY': {'Quarter': 2, 'Week': 23, 'Day': 2, 'Session': 'NY'}, 'Q3_W35_D4_London': {'Quarter': 3, 'Week': 35, 'Day': 4, 'Session': 'London'}, 'Q1_W12_D5_London': {'Quarter': 1, 'Week': 12, 'Day': 5, 'Session': 'London'}, 'Q2_W18_D1_London': {'Quarter': 2, 'Week': 18, 'Day': 1, 'Session': 'London'}, 'Q1_W9_D4_London': {'Quarter': 1, 'Week': 9, 'Day': 4, 'Session': 'London'}, 'Q1_W14_D1_NY': {'Quarter': 1, 'Week': 14, 'Day': 1, 'Session': 'NY'}, 'Q4_W50_D3_NY': {'Quarter': 4, 'Week': 50, 'Day': 3, 'Session': 'NY'}, 'Q4_W45_D3_London': {'Quarter': 4, 'Week': 45, 'Day': 3, 'Session': 'London'}, 'Q2_W15_D2_London': {'Quarter': 2, 'Week': 15, 'Day': 2, 'Session': 'London'}, 'Q2_W26_D2_London': {'Quarter': 2, 'Week': 26, 'Day': 2, 'Session': 'London'}}

class FractalSweepStrategy:
    def __init__(self, strategy_id):
        if strategy_id not in STRATEGY_CONFIGS:
            raise ValueError(f"Strategy ID '{strategy_id}' not found in configurations.")

        self.params = STRATEGY_CONFIGS[strategy_id]
        self.target = 4.0
        self.stop = 6.0

    def generate_signals(self, df):
        # Create a copy to avoid SettingWithCopyWarning
        local_df = df.copy()

        # Ensure we have a date/time column
        if 'Date' not in local_df.columns and isinstance(local_df.index, pd.DatetimeIndex):
             local_df['Date'] = local_df.index

        # --- FIX: CONVERT TO NEW YORK TIME ---
        # This ensures the dataframe matches the 'Day 7' (Sunday) logic of the configs
        if local_df['Date'].dt.tz is None:
            # Assume UTC if naive, then convert
            local_df['Date'] = local_df['Date'].dt.tz_localize('UTC').dt.tz_convert('America/New_York')
        else:
            # Just convert if already aware
            local_df['Date'] = local_df['Date'].dt.tz_convert('America/New_York')

        # Calculate Q/W/D based on NY Time
        local_df['Quarter'] = local_df['Date'].dt.quarter
        local_df['Week'] = local_df['Date'].dt.isocalendar().week
        local_df['Day'] = local_df['Date'].dt.dayofweek + 1  # 1=Monday, 7=Sunday

        # Apply filters
        mask = (
            (local_df['Quarter'] == self.params['Quarter']) &
            (local_df['Week'] == self.params['Week']) &
            (local_df['Day'] == self.params['Day'])
        )

        return local_df[mask].copy()

    def run_backtest(self, df):
        signals = self.generate_signals(df)
        return {
            'strategy_id': self.params,
            'total_trades': len(signals),
            'win_rate': 0.0
        }
